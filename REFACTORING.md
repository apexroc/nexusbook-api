# NexusBook API æ¨¡å—åŒ–é‡æ„å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

å®Œæˆäº† NexusBook API ä»**æ‰å¹³ç›®å½•ç»“æ„**åˆ°**åˆ†å±‚æ¨¡å—åŒ–æ¶æ„**çš„å®Œæ•´é‡æ„ã€‚

**é‡æ„æ—¶é—´**: 2024 å¹´ 12 æœˆ 1 æ—¥  
**ä¸»è¦æˆæœ**: âœ… ç¼–è¯‘é€šè¿‡ âœ… æ–‡æ¡£ç”ŸæˆæˆåŠŸ âœ… Git å†å²å®Œæ•´

---

## ğŸ—ï¸ æ¶æ„å˜åŒ–

### **ä¹‹å‰ï¼ˆæ‰å¹³ç»“æ„ï¼‰**

```
api/
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ auth.tsp (336 è¡Œ)
â”‚   â”œâ”€â”€ common.tsp (500 è¡Œ)
â”‚   â”œâ”€â”€ comments.tsp (471 è¡Œ)
â”‚   â”œâ”€â”€ data.tsp (463 è¡Œ)
â”‚   â”œâ”€â”€ doc.tsp (545 è¡Œ)
â”‚   â”œâ”€â”€ metadata.tsp (347 è¡Œ)
â”‚   â”œâ”€â”€ requests.tsp (545 è¡Œ)
â”‚   â”œâ”€â”€ revisions.tsp (546 è¡Œ)
â”‚   â”œâ”€â”€ settings.tsp (177 è¡Œ)
â”‚   â”œâ”€â”€ views.tsp (178 è¡Œ)
â”‚   â””â”€â”€ approvals.tsp (167 è¡Œ)
â”œâ”€â”€ main.tsp
â””â”€â”€ Auth/
    â””â”€â”€ index.tsp
```

**é—®é¢˜:**
- 11 ä¸ªæ–‡ä»¶æ‰å¹³æ”¾ç½®ï¼Œéš¾ä»¥ç†è§£æ¨¡å—èŒè´£
- æ¨¡å‹å’Œæ¥å£æ··æ‚ï¼Œé€»è¾‘å…³ç³»ä¸æ¸…æ™°
- æšä¸¾é‡å¤å®šä¹‰ï¼ˆå¦‚ `ApprovalStatus` åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ï¼‰
- æ— æ³•æ¸…æ™°åœ°è¡¨è¾¾æ¨¡å—é—´çš„ä¾èµ–å…³ç³»

### **ä¹‹åï¼ˆåˆ†å±‚æ¨¡å—åŒ–ç»“æ„ï¼‰**

```
api/
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ common.tsp (å…±äº«åŸºç¡€ç±»å‹)
â”‚   â”œâ”€â”€ constants.tsp (é›†ä¸­æšä¸¾å®šä¹‰)
â”‚   â””â”€â”€ index.tsp (æ¨¡å—å…¥å£)
â”‚
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ models.tsp (è®¤è¯æ¨¡å‹å’Œ API)
â”‚   â””â”€â”€ index.tsp (æ¨¡å—å…¥å£)
â”‚
â”œâ”€â”€ document/
â”‚   â”œâ”€â”€ core/ (æ ¸å¿ƒæ•°æ®æ¨¡å‹)
â”‚   â”‚   â”œâ”€â”€ metadata.tsp (å­—æ®µå®šä¹‰)
â”‚   â”‚   â”œâ”€â”€ data.tsp (æ•°æ®è¡Œç®¡ç†)
â”‚   â”‚   â”œâ”€â”€ properties.tsp (æ–‡æ¡£å±æ€§)
â”‚   â”‚   â”œâ”€â”€ views.tsp (è§†å›¾é…ç½®)
â”‚   â”‚   â”œâ”€â”€ settings.tsp (é…ç½®è®¾ç½®)
â”‚   â”‚   â””â”€â”€ index.tsp (æ¨¡å—å…¥å£)
â”‚   â”‚
â”‚   â”œâ”€â”€ content/ (å†…å®¹åä½œ)
â”‚   â”‚   â”œâ”€â”€ comments.tsp (è¯„è®ºç³»ç»Ÿ)
â”‚   â”‚   â””â”€â”€ index.tsp (æ¨¡å—å…¥å£)
â”‚   â”‚
â”‚   â”œâ”€â”€ workflow/ (å·¥ä½œæµç®¡ç†)
â”‚   â”‚   â”œâ”€â”€ approvals.tsp (å®¡æ‰¹æµç¨‹)
â”‚   â”‚   â”œâ”€â”€ requests.tsp (å˜æ›´è¯·æ±‚)
â”‚   â”‚   â”œâ”€â”€ revisions.tsp (ä¿®è®¢å†å²)
â”‚   â”‚   â””â”€â”€ index.tsp (æ¨¡å—å…¥å£)
â”‚   â”‚
â”‚   â”œâ”€â”€ aggregate/ (èšåˆæŸ¥è¯¢)
â”‚   â”‚   â””â”€â”€ index.tsp (èšåˆ API)
â”‚   â”‚
â”‚   â”œâ”€â”€ operations/ (é¢„ç•™ç›®å½•)
â”‚   â”œâ”€â”€ index.tsp (ä¸»æ¨¡å—å…¥å£)
â”‚   â””â”€â”€ Doc.md (æ–‡æ¡£)
â”‚
â”œâ”€â”€ extensions/ (é¢„ç•™ç›®å½•)
â”‚   â”œâ”€â”€ integrations/
â”‚   â””â”€â”€ webhooks/
â”‚
â””â”€â”€ main.tsp (é¡¶å±‚å…¥å£)
```

**ä¼˜åŠ¿:**
- âœ… æ¸…æ™°çš„ 4 å±‚åˆ†å±‚ç»“æ„ï¼šbasic â†’ auth â†’ document â†’ extensions
- âœ… å•ä¸€èŒè´£åŸåˆ™ï¼šæ¯ä¸ªæ¨¡å—åŠŸèƒ½æ¸…æ™°
- âœ… æ˜ç¡®çš„ä¾èµ–å…³ç³»ï¼šåŸºç¡€å±‚ â†’ åŠŸèƒ½å±‚
- âœ… æ˜“äºæ‰©å±•ï¼šextensions æ¨¡å—é¢„ç•™ç©ºé—´
- âœ… ä»£ç å¤ç”¨ï¼šshared æ¨¡å—ä¸­çš„å…¬å…±ç±»å‹è¢«æ‰€æœ‰æ¨¡å—ä½¿ç”¨

---

## ğŸ“Š æ–‡ä»¶è¿ç§»è¯¦æƒ…

### **ç¬¬ä¸€é˜¶æ®µï¼šShared æ¨¡å—ï¼ˆåŸºç¡€å±‚ï¼‰**

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¡Œæ•° | å¤‡æ³¨ |
|------|--------|------|------|
| types/common.tsp | shared/common.tsp | 500 | æ‰€æœ‰å…±äº«åŸºç¡€ç±»å‹ |
| å¤šä¸ªæ–‡ä»¶ | shared/constants.tsp | ~200 | æšä¸¾é›†ä¸­ç®¡ç† |
| - | shared/index.tsp | ~20 | æ¨¡å—å…¥å£ |

**æšä¸¾é›†ä¸­ç®¡ç†:**
- `RequestStatus` (open, merged, closed)
- `ApprovalStatus` (pending, approved, rejected, canceled)
- `ApprovalDecision` (approved, rejected)
- `ViewType` (grid, gallery, kanban, document)
- `FieldType` (25+ å­—æ®µç±»å‹)
- `DocumentType` ç­‰

### **ç¬¬äºŒé˜¶æ®µï¼šAuth æ¨¡å—ï¼ˆè®¤è¯å±‚ï¼‰**

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¡Œæ•° | ä¿®æ”¹ |
|------|--------|------|------|
| types/auth.tsp | auth/models.tsp | 336 | æ›´æ–°å¯¼å…¥è·¯å¾„ |
| - | auth/index.tsp | ~15 | æ–°å¢æ¨¡å—å…¥å£ |

**ä¿®æ”¹å†…å®¹:**
- å¯¼å…¥ä» `../types/common.tsp` æ”¹ä¸º `../../shared/index.tsp`
- æ·»åŠ æ¨¡å—æ³¨é‡Šå’Œæ–‡æ¡£

### **ç¬¬ä¸‰é˜¶æ®µï¼šDocument æ¨¡å—ï¼ˆä¸šåŠ¡å±‚ï¼‰**

#### Core å­æ¨¡å—ï¼ˆæ ¸å¿ƒæ•°æ®ï¼‰

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¡Œæ•° | ä¿®æ”¹ |
|------|--------|------|------|
| types/metadata.tsp | document/core/metadata.tsp | 347 | å¯¼å…¥è·¯å¾„æ›´æ–° |
| types/data.tsp | document/core/data.tsp | 463 | å¯¼å…¥è·¯å¾„æ›´æ–° |
| types/views.tsp | document/core/views.tsp | 178 | å¯¼å…¥è·¯å¾„æ›´æ–° |
| types/settings.tsp | document/core/settings.tsp | 177 | å¯¼å…¥è·¯å¾„æ›´æ–° |
| types/doc.tsp (åˆ†å‰²) | document/core/properties.tsp | ~395 | ä» doc.tsp åˆ†å‰² |

#### Content å­æ¨¡å—ï¼ˆåä½œå†…å®¹ï¼‰

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¡Œæ•° | ä¿®æ”¹ |
|------|--------|------|------|
| types/comments.tsp | document/content/comments.tsp | 471 | å¯¼å…¥è·¯å¾„æ›´æ–° |

#### Workflow å­æ¨¡å—ï¼ˆå·¥ä½œæµï¼‰

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¡Œæ•° | ä¿®æ”¹ |
|------|--------|------|------|
| types/approvals.tsp | document/workflow/approvals.tsp | 167 | ä½¿ç”¨ shared/constants ä¸­çš„æšä¸¾ |
| types/requests.tsp | document/workflow/requests.tsp | 545 | ä½¿ç”¨ shared/constants ä¸­çš„æšä¸¾ |
| types/revisions.tsp | document/workflow/revisions.tsp | 546 | å¯¼å…¥è·¯å¾„æ›´æ–° |

#### Aggregate å­æ¨¡å—ï¼ˆèšåˆæŸ¥è¯¢ï¼‰

| æºæ–‡ä»¶ | ç›®æ ‡ä½ç½® | è¡Œæ•° | å¤‡æ³¨ |
|------|--------|------|------|
| types/doc.tsp (åˆ†å‰²) | document/aggregate/index.tsp | ~150 | åŒ…å« DocIdentã€DocBundleã€DocumentAggregateApi |

### **ç‰¹æ®Šå¤„ç†ï¼šdoc.tsp åˆ†å‰²**

`types/doc.tsp` (545 è¡Œ) åŒ…å«ä¸¤ä¸ªåŠŸèƒ½ï¼š
- **èšåˆåŒ…éƒ¨åˆ†** â†’ `document/aggregate/index.tsp` (~150 è¡Œ)
- **å±æ€§éƒ¨åˆ†** â†’ `document/core/properties.tsp` (~395 è¡Œ)

è¿™æ ·åˆ†å‰²åï¼š
- èŒè´£æ›´æ¸…æ™°
- ä»£ç æ›´æ˜“ç»´æŠ¤
- é¿å…äº†å¾ªç¯ä¾èµ–

---

## ğŸ”„ ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              main.tsp                     â”‚
â”‚            (é¡¶å±‚å…¥å£)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        â”‚        â”‚              â”‚
    â–¼        â–¼        â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ shared â”‚ â”‚auth â”‚ â”‚document  â”‚ â”‚extensions â”‚
â”‚        â”‚ â”‚     â”‚ â”‚          â”‚ â”‚ (reserved)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â–²        â–²         â–²
    â”‚        â”‚         â””â”€â”€â”€ ä¾èµ– shared
    â”‚        â”‚               â”œâ”€ core/
    â”‚        â”‚               â”œâ”€ content/
    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä¾èµ– shared
    â”‚
    â””â”€ åŸºç¡€å±‚ï¼šå¸¸æ•°ã€é€šç”¨ç±»å‹ã€å·¥å…·å‡½æ•°
```

**ä¾èµ–åŸåˆ™:**
- æ‰€æœ‰æ¨¡å—ä¾èµ– `shared/`
- åŒå±‚æ¨¡å—ä¹‹é—´å¯ç›¸äº’ä¾èµ–
- ä¸å…è®¸å‘ä¸Šä¾èµ–ï¼ˆä¸‹å±‚ä¸ä¾èµ–ä¸Šå±‚ï¼‰

---

## âœ… éªŒè¯ä¸æµ‹è¯•

### ç¼–è¯‘éªŒè¯

```bash
âœ” TypeSpec ç¼–è¯‘æˆåŠŸ
âœ” OpenAPI 3.0 è§„èŒƒç”ŸæˆæˆåŠŸ
âœ” æ— é”™è¯¯å’Œè­¦å‘Š
```

### æ–‡æ¡£ç”Ÿæˆ

```bash
âœ” æ–‡æ¡£ç”ŸæˆæˆåŠŸ
âœ” ç”Ÿæˆæ–‡ä»¶ï¼šdist/redoc/index.html (1102 KiB)
âœ” æ‰€æœ‰ç«¯ç‚¹å¯æ­£å¸¸è®¿é—®
```

### å¯¼å…¥è·¯å¾„éªŒè¯

æ‰€æœ‰å¯¼å…¥è·¯å¾„å·²æ›´æ–°ï¼š
- âŒ `../types/common.tsp` â†’ âœ… `../../shared/index.tsp`
- âŒ `../types/metadata.tsp` â†’ âœ… æœ¬åœ°æ¨¡å— (same directory)

---

## ğŸ“¦ Git æäº¤å†å²

```
8ce4df4 refactor: åˆ é™¤æ—§çš„ api/types/ ç›®å½•
b1c5dc8 refactor: å®Œæˆ API æ¨¡å—åŒ–é‡æ„ï¼Œé‡ç»„ä¸º sharedã€authã€document ä¸‰å±‚æ¨¡å—
```

**æäº¤ç»Ÿè®¡:**
- 20 ä¸ªæ–°æ–‡ä»¶åˆ›å»º
- 11 ä¸ªæ—§æ–‡ä»¶åˆ é™¤
- æ€»è®¡çº¦ 4000+ è¡Œä»£ç é‡æ–°ç»„ç»‡

---

## ğŸš€ åç»­æ”¹è¿›ç©ºé—´

### 1. **æ‰©å±•æ¨¡å—** (`api/extensions/`)

```
extensions/
â”œâ”€â”€ integrations/
â”‚   â”œâ”€â”€ slack.tsp
â”‚   â”œâ”€â”€ webhook.tsp
â”‚   â””â”€â”€ index.tsp
â”œâ”€â”€ webhooks/
â”‚   â”œâ”€â”€ events.tsp
â”‚   â””â”€â”€ subscriptions.tsp
â””â”€â”€ index.tsp
```

### 2. **Operations ç›®å½•é¢„ç•™** (`api/document/operations/`)

å¯ä»¥è¿›ä¸€æ­¥åˆ†å‰² API ç«¯ç‚¹ä¸ºå•ç‹¬æ–‡ä»¶ï¼š
```
operations/
â”œâ”€â”€ metadata-ops.tsp
â”œâ”€â”€ data-ops.tsp
â”œâ”€â”€ properties-ops.tsp
â””â”€â”€ ...
```

### 3. **æ–‡æ¡£å®Œå–„**

åœ¨å„æ¨¡å—ä¸­æ·»åŠ æ›´è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—å’Œç¤ºä¾‹

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### å¯¼å…¥å…±äº«ç±»å‹

```typespec
import "../../shared/index.tsp";

// ä½¿ç”¨å…±äº«æšä¸¾
model MyModel {
  status: NexusBook.Common.RequestStatus;
}
```

### åœ¨ Document æ¨¡å—ä¸­ä½¿ç”¨

```typespec
import "../../shared/index.tsp";
import "../core/metadata.tsp";

// ä½¿ç”¨æ ¸å¿ƒæ¨¡å‹
model MyDocModel {
  metadata: Metadata;
}
```

---

## ğŸ“ æ€»ç»“

æœ¬æ¬¡é‡æ„å°† NexusBook API ä»**æ‰å¹³çš„å•ä¸€ç»“æ„**è½¬å˜ä¸º**æ¸…æ™°çš„åˆ†å±‚æ¨¡å—åŒ–æ¶æ„**ï¼Œå–å¾—ä»¥ä¸‹æˆæœï¼š

| æŒ‡æ ‡ | æ”¹è¿› |
|------|------|
| ä»£ç ç»„ç»‡ | ğŸŸ¢ ä»æ··ä¹±åˆ°æ¸…æ™° |
| æ¨¡å—èŒè´£ | ğŸŸ¢ å•ä¸€èŒè´£åŸåˆ™ |
| ä¾èµ–å…³ç³» | ğŸŸ¢ æ¸…æ™°çš„ä¾èµ–å›¾ |
| å¯ç»´æŠ¤æ€§ | ğŸŸ¢ å¤§å¹…æå‡ |
| æ‰©å±•æ€§ | ğŸŸ¢ ä¸ºæœªæ¥é¢„ç•™ç©ºé—´ |
| ç¼–è¯‘æˆåŠŸ | ğŸŸ¢ 100% é€šè¿‡ |
| æ–‡æ¡£ç”Ÿæˆ | ğŸŸ¢ 100% æˆåŠŸ |

**ä¸‹ä¸€æ­¥:** è€ƒè™‘è¿›ä¸€æ­¥çš„ API æ“ä½œæ¨¡å—åŒ–å’Œé›†æˆæ¨¡å—çš„å®ç°ã€‚
