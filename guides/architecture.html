<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶æ„è®¾è®¡ - NexusBook API æ–‡æ¡£</title>
    <link rel="stylesheet" href="/styles/main.css?v=${Date.now()}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js"></script>
    <script>
      if (window.hljs) { hljs.highlightAll(); }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
      mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body class="has-sidebar">
    <nav class="sidebar">
<div class="sidebar-header">
<a href="/index.html" class="sidebar-logo">NexusBook API</a>
</div>
<div class="sidebar-content">
<div class="sidebar-group expanded">
<div class="sidebar-group-title">å¼€å§‹ä½¿ç”¨</div>
<ul class="sidebar-items">
<li class="sidebar-item ">
<a href="/index.html">æ¦‚è§ˆ</a>
</li>
<li class="sidebar-item ">
<a href="/guides/getting-started.html">å¿«é€Ÿå¼€å§‹</a>
</li>
<li class="sidebar-item ">
<a href="/guides/authentication.html">è®¤è¯æˆæƒ</a>
</li>
</ul>
</div>
<div class="sidebar-group expanded">
<div class="sidebar-group-title">æ ¸å¿ƒæ¦‚å¿µ</div>
<ul class="sidebar-items">
<li class="sidebar-item ">
<a href="/guides/document-model.html">æ–‡æ¡£æ¨¡å‹</a>
</li>
<li class="sidebar-item ">
<a href="/guides/data-operations.html">æ•°æ®æ“ä½œ</a>
</li>
<li class="sidebar-item ">
<a href="/guides/webhooks.html">Webhook äº‹ä»¶</a>
</li>
<li class="sidebar-item ">
<a href="/guides/realtime-collaboration.html">å®æ—¶ååŒ</a>
</li>
</ul>
</div>
<div class="sidebar-group expanded">
<div class="sidebar-group-title">API å‚è€ƒ</div>
<ul class="sidebar-items">
<li class="sidebar-item ">
<a href="/api/index.html">API ç«¯ç‚¹</a>
</li>
<li class="sidebar-item ">
<a href="/references/field-types.html">å­—æ®µç±»å‹</a>
</li>
<li class="sidebar-item ">
<a href="/references/error-codes.html">é”™è¯¯ç </a>
</li>
</ul>
</div>
<div class="sidebar-group ">
<div class="sidebar-group-title">å¼€å‘æŒ‡å—</div>
<ul class="sidebar-items">
<li class="sidebar-item ">
<a href="/guides/development.html">å¼€å‘ç¯å¢ƒ</a>
</li>
<li class="sidebar-item ">
<a href="/guides/architecture.html">æ¶æ„è®¾è®¡</a>
</li>
<li class="sidebar-item ">
<a href="/guides/best-practices.html">æœ€ä½³å®è·µ</a>
</li>
<li class="sidebar-item ">
<a href="/guides/examples.html">å®Œæ•´ç¤ºä¾‹</a>
</li>
</ul>
</div>
<div class="sidebar-group ">
<div class="sidebar-group-title">å…¶ä»–èµ„æº</div>
<ul class="sidebar-items">
<li class="sidebar-item ">
<a href="/references/i18n.html">å›½é™…åŒ–</a>
</li>
<li class="sidebar-item ">
<a href="/references/changelog.html">æ›´æ–°æ—¥å¿—</a>
</li>
<li class="sidebar-item ">
<a href="/CONTRIBUTING.html">è´¡çŒ®æŒ‡å—</a>
</li>
<li class="sidebar-item ">
<a href="/TROUBLESHOOTING.html">é—®é¢˜æ’æŸ¥</a>
</li>
</ul>
</div>
</div>
</nav>

    
    <div class="main-wrapper">
        <header class="header">
            <div class="container">
                <h1 class="logo"><a href="/index.html">NexusBook API</a></h1>
                <nav class="nav">
                    <a href="/index.html">é¦–é¡µ</a>
                    <a href="/api/" >API å‚è€ƒ</a>
                    <a href="/guides/getting-started.html" class="active">å¼€å‘æŒ‡å—</a>
                    <a href="/references/error-codes.html" >å‚è€ƒæ–‡æ¡£</a>
                    <a href="https://github.com/NexusBook/nexusbook-api" target="_blank">GitHub</a>
                </nav>
            </div>
        </header>

        <main class="main content-page">
            <div class="container">
                <article class="content">
                    <h1>æ¶æ„è®¾è®¡</h1>
<p>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» NexusBook API çš„æ¶æ„è®¾è®¡ã€ç›®å½•ç»“æ„å’Œè®¾è®¡åŸåˆ™ã€‚</p>
<h2>Document æ ¸å¿ƒæ¦‚å¿µæ¶æ„</h2>
<div class="mermaid">graph TB
    subgraph "Document æ–‡æ¡£æŠ½è±¡"
        Doc["ğŸ“„ Document<br/>{doc-type}/{doc-id}"]
        
        subgraph "æ ¸å¿ƒæ•°æ®å±‚ Core Data"
            Props["ğŸ·ï¸ Properties<br/>æ–‡æ¡£å±æ€§<br/><small>è®¢å•æ—¶é—´ã€é—¨åº—ã€é‡‘é¢</small>"]
            Meta["ğŸ“‹ Metadata<br/>å­—æ®µå®šä¹‰<br/><small>25+ å­—æ®µç±»å‹</small>"]
            Views["ğŸ‘ï¸ Views<br/>è§†å›¾é…ç½®<br/><small>8 ç§è§†å›¾ç±»å‹</small>"]
            Data["ğŸ“Š Data<br/>æ•°æ®è¡Œ<br/><small>ç»“æ„åŒ–æ•°æ®</small>"]
            Settings["âš™ï¸ Settings<br/>é…ç½®<br/><small>æ–‡æ¡£/ç±»å‹çº§</small>"]
        end
        
        subgraph "åä½œå±‚ Collaboration"
            Comments["ğŸ’¬ Comments<br/>è¯„è®ºç³»ç»Ÿ<br/><small>æ–‡æ¡£/å­—æ®µ/è¡Œ/å•å…ƒæ ¼</small>"]
        end
        
        subgraph "å·¥ä½œæµå±‚ Workflow"
            Requests["ğŸ“ Requests<br/>å˜æ›´è¯·æ±‚<br/><small>ç±»ä¼¼ Git PR</small>"]
            Revisions["ğŸ“œ Revisions<br/>ä¿®è®¢å†å²<br/><small>å®Œæ•´å˜æ›´è¿½è¸ª</small>"]
            Approvals["âœ… Approvals<br/>å®¡æ‰¹æµç¨‹<br/><small>å¤šå±‚çº§å®¡æ‰¹</small>"]
        end
    end
    
    subgraph "æŸ¥è¯¢èƒ½åŠ› Query Engine"
        Filter["ğŸ” Filter<br/>è¿‡æ»¤å™¨<br/><small>åµŒå¥—é€»è¾‘</small>"]
        Sort["ğŸ“¶ Sort<br/>æ’åº<br/><small>å¤šå­—æ®µ</small>"]
        Group["ğŸ“Š Group<br/>åˆ†ç»„èšåˆ<br/><small>5 ç§èšåˆå‡½æ•°</small>"]
        Aggregate["ğŸ¯ Aggregate<br/>èšåˆæŸ¥è¯¢<br/><small>ä¸€æ¬¡è·å–å¤šç§æ•°æ®</small>"]
    end
    
    subgraph "è®¤è¯æˆæƒ Auth"
        OAuth["ğŸ” OAuth2/OIDC<br/>æ ‡å‡†è®¤è¯"]
        Token["ğŸ« JWT Token<br/>ä»¤ç‰Œç®¡ç†"]
        Scope["ğŸ”‘ Scopes<br/>æƒé™æ§åˆ¶"]
    end
    
    Doc --> Props
    Doc --> Meta
    Doc --> Views
    Doc --> Data
    Doc --> Settings
    Doc --> Comments
    Doc --> Requests
    Doc --> Revisions
    Doc --> Approvals
    
    Data --> Filter
    Data --> Sort
    Data --> Group
    Doc --> Aggregate
    
    Requests -->|åˆå¹¶ç”Ÿæˆ| Revisions
    Requests -->|å¯é€‰| Approvals
    Data -->|é»˜è®¤ç”Ÿæˆ| Requests
    %% Removed apply=true edge
    
    OAuth --> Token
    Token --> Scope
    Scope --> Doc</div>
<p><strong>æ ¸å¿ƒæ¦‚å¿µè¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>Document</strong> - ç»Ÿä¸€çš„æ–‡æ¡£æŠ½è±¡ï¼Œæ”¯æŒå¤šç§ä¸šåŠ¡ç±»å‹ï¼ˆè®¢è´§å•ã€äº§å“ã€åº“å­˜ç­‰ï¼‰</li>
<li><strong>æ ¸å¿ƒæ•°æ®å±‚</strong> - Propertiesï¼ˆæ–‡æ¡£å±æ€§ï¼‰ã€Metadataï¼ˆå­—æ®µå®šä¹‰ï¼‰ã€Viewsï¼ˆè§†å›¾ï¼‰ã€Dataï¼ˆæ•°æ®è¡Œï¼‰ã€Settingsï¼ˆé…ç½®ï¼‰</li>
<li><strong>åä½œå±‚</strong> - Comments æ”¯æŒåœ¨æ–‡æ¡£ä»»ä½•ä½ç½®è¿›è¡Œè¯„è®ºå’Œè®¨è®º</li>
<li><strong>å·¥ä½œæµå±‚</strong> - Requestsï¼ˆå˜æ›´è¯·æ±‚ï¼‰â†’ Revisionsï¼ˆä¿®è®¢å†å²ï¼‰+ Approvalsï¼ˆå®¡æ‰¹æµç¨‹ï¼‰</li>
<li><strong>æŸ¥è¯¢èƒ½åŠ›</strong> - å¼ºå¤§çš„è¿‡æ»¤ã€æ’åºã€åˆ†ç»„å’ŒèšåˆæŸ¥è¯¢</li>
<li><strong>è®¤è¯æˆæƒ</strong> - OAuth2/OIDC æ ‡å‡†è®¤è¯ï¼ŒåŸºäº Scope çš„æƒé™æ§åˆ¶</li>
</ul>
<h2>ç§Ÿæˆ·æ•°æ®æ ¸å¿ƒæ¦‚å¿µæ¶æ„</h2>
<p>NexusBook é‡‡ç”¨å¤šç§Ÿæˆ· SaaS æ¶æ„ï¼Œé€šè¿‡ Organizationï¼ˆç»„ç»‡ï¼‰å’Œ Workspaceï¼ˆå·¥ä½œåŒºï¼‰å®ç°æ•°æ®éš”ç¦»å’Œæƒé™ç®¡ç†ï¼Œè®¾è®¡ç†å¿µå‚è€ƒ Miro çš„åä½œæ¨¡å¼ã€‚</p>
<div class="mermaid">graph TB
    subgraph "å¤šç§Ÿæˆ·æ¶æ„ Multi-Tenant Architecture"
        User["ğŸ‘¤ User<br/>ç”¨æˆ·<br/><small>ç‹¬ç«‹å®ä½“</small>"]
        
        subgraph "Organization ç»„ç»‡ï¼ˆç§Ÿæˆ·ï¼‰"
            Org["ğŸ¢ Organization<br/>ç»„ç»‡/ç§Ÿæˆ·<br/><small>æ•°æ®éš”ç¦»è¾¹ç•Œ</small>"]
            OrgMember["ğŸ‘¥ Organization Members<br/>ç»„ç»‡æˆå‘˜<br/><small>owner/admin/member/guest</small>"]
            
            subgraph "å…±äº«å·¥ä½œåŒº Shared Workspace"
                MasterWS["ğŸ“š ä¸»æ•°æ®ä¸­å¿ƒ<br/>Master Data Workspace<br/><small>visibility: public</small>"]
                MasterDoc1["ğŸ“„ äº§å“ç›®å½•<br/><small>product</small>"]
                MasterDoc2["ğŸ“„ ä¾›åº”å•†åå½•<br/><small>supplier</small>"]
                MasterDoc3["ğŸ“„ æ ‡å‡†èœè°±<br/><small>recipe</small>"]
            end
            
            subgraph "ä¸šåŠ¡å·¥ä½œåŒº Business Workspaces"
                WS1["ğŸœ æœé˜³é¤å…<br/>Workspace<br/><small>visibility: private</small>"]
                WS2["ğŸ›ï¸ æµ·æ·€è¶…å¸‚<br/>Workspace<br/><small>visibility: private</small>"]
                WS3["ğŸšš ç»¿æºä¾›åº”å•†<br/>Workspace<br/><small>visibility: private</small>"]
            end
            
            WSMember["ğŸ‘¥ Workspace Members<br/>å·¥ä½œåŒºæˆå‘˜<br/><small>owner/editor/viewer</small>"]
            
            Invite["âœ‰ï¸ Invitation<br/>é‚€è¯·æœºåˆ¶<br/><small>é‚®ç®±é‚€è¯·</small>"]
            JoinReq["ğŸ“ Join Request<br/>åŠ å…¥ç”³è¯·<br/><small>ç”¨æˆ·ä¸»åŠ¨ç”³è¯·</small>"]
        end
        
        subgraph "ä¸šåŠ¡æ–‡æ¡£ Business Documents"
            Doc1["ğŸ“„ è®¢è´§å•<br/><small>purchase</small>"]
            Doc2["ğŸ“„ åº“å­˜è¡¨<br/><small>inventory</small>"]
            Doc3["ğŸ“„ é”€å”®è®°å½•<br/><small>sales</small>"]
        end
    end
    
    User -->|æ³¨å†Œæ—¶è‡ªåŠ¨åˆ›å»º| Org
    User -->|owner| Org
    User -->|åŠ å…¥| OrgMember
    
    Org -->|åŒ…å«| MasterWS
    Org -->|åŒ…å«1-N| WS1
    Org -->|åŒ…å«1-N| WS2
    Org -->|åŒ…å«1-N| WS3
    
    MasterWS -->|ç®¡ç†å…±äº«æ•°æ®| MasterDoc1
    MasterWS -->|ç®¡ç†å…±äº«æ•°æ®| MasterDoc2
    MasterWS -->|ç®¡ç†å…±äº«æ•°æ®| MasterDoc3
    
    OrgMember -->|éœ€æ˜¾å¼åŠ å…¥| WSMember
    
    Org -->|é‚€è¯·ç”¨æˆ·| Invite
    Org -->|æ¥å—ç”³è¯·| JoinReq
    
    WS1 -->|ç®¡ç†ä¸šåŠ¡æ•°æ®| Doc1
    WS2 -->|ç®¡ç†ä¸šåŠ¡æ•°æ®| Doc2
    WS3 -->|ç®¡ç†ä¸šåŠ¡æ•°æ®| Doc3
    
    Doc1 -.->|relationå­—æ®µå¼•ç”¨| MasterDoc1
    Doc2 -.->|relationå­—æ®µå¼•ç”¨| MasterDoc1
    Doc3 -.->|relationå­—æ®µå¼•ç”¨| MasterDoc2
    
    style Org fill:#e1f5ff
    style MasterWS fill:#d4edda
    style WS1 fill:#fff4e6
    style WS2 fill:#fff4e6
    style WS3 fill:#fff4e6
    style User fill:#f0f0f0
    style MasterDoc1 fill:#c3e6cb
    style MasterDoc2 fill:#c3e6cb
    style MasterDoc3 fill:#c3e6cb</div>
<h3>æ ¸å¿ƒæ¦‚å¿µè¯´æ˜</h3>
<h4>1. Userï¼ˆç”¨æˆ·ï¼‰- ç‹¬ç«‹èº«ä»½å®ä½“</h4>
<ul>
<li><strong>ç‹¬ç«‹æ€§</strong>ï¼šç”¨æˆ·æ˜¯ç³»ç»Ÿä¸­çš„ç‹¬ç«‹å®ä½“ï¼Œä¸ä¾é™„äºä»»ä½•ç»„ç»‡</li>
<li><strong>è‡ªåŠ¨ç»„ç»‡</strong>ï¼šç”¨æˆ·æ³¨å†Œæ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Personal ç±»å‹çš„ Organizationï¼Œç”¨æˆ·æˆä¸ºè¯¥ç»„ç»‡çš„ owner</li>
<li><strong>å¤šç»„ç»‡æˆå‘˜</strong>ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶æ˜¯å¤šä¸ª Organization çš„æˆå‘˜</li>
<li><strong>èº«ä»½éªŒè¯</strong>ï¼šæ”¯æŒé‚®ç®±/å¯†ç ã€OAuth ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆGoogleã€GitHubã€å¾®ä¿¡ã€é’‰é’‰ã€é£ä¹¦ï¼‰</li>
</ul>
<h4>2. Organizationï¼ˆç»„ç»‡ï¼‰- ç§Ÿæˆ·è¾¹ç•Œ</h4>
<ul>
<li><strong>ç§Ÿæˆ·éš”ç¦»</strong>ï¼šOrganization æ˜¯æ•°æ®éš”ç¦»çš„åŸºæœ¬å•å…ƒï¼Œç±»ä¼¼ Miro çš„ Team</li>
<li><strong>ç»„ç»‡ç±»å‹</strong>ï¼š<ul>
<li><code>personal</code>ï¼šä¸ªäººç»„ç»‡ï¼ˆç”¨æˆ·æ³¨å†Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼‰</li>
<li><code>team</code>ï¼šå›¢é˜Ÿç»„ç»‡</li>
<li><code>enterprise</code>ï¼šä¼ä¸šç»„ç»‡</li>
</ul>
</li>
<li><strong>æˆå‘˜è§’è‰²</strong>ï¼š<ul>
<li><code>owner</code>ï¼šç»„ç»‡æ‹¥æœ‰è€…ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™ï¼ˆåŒ…æ‹¬åˆ é™¤ç»„ç»‡ã€è½¬è®©æ‰€æœ‰æƒï¼‰</li>
<li><code>admin</code>ï¼šç®¡ç†å‘˜ï¼Œå¯ç®¡ç†æˆå‘˜ã€å·¥ä½œåŒºã€ç»„ç»‡è®¾ç½®</li>
<li><code>member</code>ï¼šæ™®é€šæˆå‘˜ï¼Œå¯è®¿é—®è¢«æˆæƒçš„å·¥ä½œåŒº</li>
<li><code>guest</code>ï¼šè®¿å®¢ï¼Œä»…èƒ½è®¿é—®ç‰¹å®šèµ„æº</li>
</ul>
</li>
<li><strong>é»˜è®¤å·¥ä½œåŒº</strong>ï¼šåˆ›å»ºç»„ç»‡æ—¶è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªé»˜è®¤ Workspace</li>
</ul>
<h4>3. Workspaceï¼ˆå·¥ä½œåŒºï¼‰- ä¸šåŠ¡å®¹å™¨</h4>
<p>Workspace åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š<strong>å…±äº«å·¥ä½œåŒº</strong>å’Œ<strong>ä¸šåŠ¡å·¥ä½œåŒº</strong>ã€‚</p>
<p><strong>ğŸ“š å…±äº«å·¥ä½œåŒºï¼ˆä¸»æ•°æ®ä¸­å¿ƒï¼‰</strong>ï¼š</p>
<ul>
<li><strong>ç‰¹æ®Šæ ‡è¯†</strong>ï¼š<code>visibility: public</code>ï¼Œç»„ç»‡å†…æ‰€æœ‰æˆå‘˜å¯è§</li>
<li><strong>ä¸»è¦èŒè´£</strong>ï¼šå­˜æ”¾ç»„ç»‡çº§å…±äº«ä¸»æ•°æ®ï¼Œä¾›å¤šä¸ªä¸šåŠ¡å·¥ä½œåŒºå¼•ç”¨</li>
<li><strong>å…¸å‹æ•°æ®</strong>ï¼š<ul>
<li>äº§å“ç›®å½•ï¼šé¤é¥®é›†å›¢çš„æ‰€æœ‰èœå“ä¿¡æ¯</li>
<li>ä¾›åº”å•†åå½•ï¼šå…¨éƒ¨åˆä½œä¾›åº”å•†çš„è”ç³»ä¿¡æ¯</li>
<li>æ ‡å‡†èœè°±ï¼šé›†å›¢ç»Ÿä¸€çš„èœå“åˆ¶ä½œæ ‡å‡†</li>
<li>è´¨é‡æ ‡å‡†ã€æ ‡å‡†æ“ä½œæµç¨‹ç­‰</li>
</ul>
</li>
<li><strong>æƒé™æ§åˆ¶</strong>ï¼š<ul>
<li>æ•°æ®ç®¡ç†å‘˜ï¼š<code>editor</code>ï¼ˆå¯ç¼–è¾‘ä¸»æ•°æ®ï¼‰</li>
<li>ä¸šåŠ¡äººå‘˜ï¼š<code>viewer</code>ï¼ˆåªè¯»è®¿é—®ï¼Œä¸èƒ½ä¿®æ”¹ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>ğŸœ ä¸šåŠ¡å·¥ä½œåŒº</strong>ï¼š</p>
<ul>
<li><strong>ä¸šåŠ¡éš”ç¦»</strong>ï¼šWorkspace æ˜¯å®é™…ä¸šåŠ¡å¼€å±•çš„å®¹å™¨ï¼Œæ‰¿è½½ä¾›åº”é“¾ç®¡ç†çš„å„ç§ä¸šåŠ¡</li>
<li><strong>ç°å®æ˜ å°„</strong>ï¼š<ul>
<li>ğŸœ é¤å…ï¼šæ¯å®¶é¤å…çš„ç‹¬ç«‹è¿è¥ç®¡ç†ï¼ˆæœé˜³é¤å…ã€è¥¿åŸé¤å…ç­‰ï¼‰</li>
<li>ğŸ›ï¸ è¶…å¸‚ï¼šè¶…å¸‚çš„é‡‡è´­ä¸åº“å­˜ç®¡ç†ï¼ˆæµ·æ·€è¶…å¸‚ã€è¥¿å•è¶…å¸‚ç­‰ï¼‰</li>
<li>ğŸšš ä¾›åº”å•†ï¼šä¾›åº”å•†çš„è®¢å•ä¸å‘è´§ç®¡ç†ï¼ˆç»¿æºä¾›åº”å•†ã€ä¸°æ”¶å†œåœºç­‰ï¼‰</li>
<li>ğŸ­ ä»“åº“ï¼šä»“åº“çš„è¿›å‡ºåº“ç®¡ç†</li>
</ul>
</li>
<li><strong>æ˜¾å¼åŠ å…¥</strong>ï¼šç»„ç»‡æˆå‘˜éœ€è¦è¢«æ˜¾å¼æ·»åŠ åˆ° Workspace æ‰èƒ½è®¿é—®å…¶ä¸­çš„å†…å®¹</li>
<li><strong>æˆå‘˜è§’è‰²</strong>ï¼š<ul>
<li><code>owner</code>ï¼šå·¥ä½œåŒºè´Ÿè´£äººï¼Œå¯ç®¡ç†å·¥ä½œåŒºå’Œæˆå‘˜</li>
<li><code>editor</code>ï¼šç¼–è¾‘è€…ï¼Œå¯åˆ›å»ºå’Œç¼–è¾‘æ–‡æ¡£</li>
<li><code>viewer</code>ï¼šæŸ¥çœ‹è€…ï¼Œåªè¯»æƒé™</li>
</ul>
</li>
<li><strong>å¯è§æ€§æ§åˆ¶</strong>ï¼š<ul>
<li><code>public</code>ï¼šç»„ç»‡å†…æ‰€æœ‰æˆå‘˜å¯è§</li>
<li><code>private</code>ï¼šä»…æˆå‘˜å¯è§ï¼ˆå»ºè®®ä¸šåŠ¡å·¥ä½œåŒºä½¿ç”¨ï¼‰</li>
</ul>
</li>
</ul>
<h4>4. Workspace ä¸ Document çš„å…³ç³»</h4>
<p><strong>ä¸€å¯¹å¤šå…³ç³»</strong>ï¼šä¸€ä¸ª Workspace å¯ä»¥åŒ…å«å¤šä¸ª Document</p>
<p><strong>å…±äº«å·¥ä½œåŒºçš„ Document</strong>ï¼š</p>
<ul>
<li>äº§å“ç›®å½• Documentï¼ˆ<code>product</code> ç±»å‹ï¼‰</li>
<li>ä¾›åº”å•†åå½• Documentï¼ˆ<code>supplier</code> ç±»å‹ï¼‰</li>
<li>æ ‡å‡†èœè°± Documentï¼ˆ<code>recipe</code> ç±»å‹ï¼‰</li>
</ul>
<p><strong>ä¸šåŠ¡å·¥ä½œåŒºçš„ Document</strong>ï¼š</p>
<ul>
<li>è®¢è´§å• Documentï¼ˆ<code>purchase</code> ç±»å‹ï¼‰</li>
<li>åº“å­˜è¡¨ Documentï¼ˆ<code>inventory</code> ç±»å‹ï¼‰</li>
<li>é”€å”®è®°å½• Documentï¼ˆ<code>sales</code> ç±»å‹ï¼‰</li>
<li>å‘è´§å• Documentï¼ˆ<code>shipment</code> ç±»å‹ï¼‰</li>
</ul>
<p><strong>è·¨ Workspace æ•°æ®å¼•ç”¨</strong>ï¼š</p>
<ul>
<li>ä¸šåŠ¡å·¥ä½œåŒºçš„ Document å¯ä»¥é€šè¿‡ <code>relation</code> å­—æ®µç±»å‹å¼•ç”¨å…±äº«å·¥ä½œåŒºçš„ä¸»æ•°æ®</li>
<li>ä¾‹å¦‚ï¼šé¤å…çš„è®¢è´§å•ä¸­çš„â€œäº§å“â€å­—æ®µå…³è”åˆ°ä¸»æ•°æ®ä¸­å¿ƒçš„â€œäº§å“ç›®å½•â€</li>
<li>å®ç°æ•°æ®ä¸€è‡´æ€§ï¼šä¸»æ•°æ®æ›´æ–°åï¼Œæ‰€æœ‰å¼•ç”¨å¤„è‡ªåŠ¨ç”Ÿæ•ˆ</li>
</ul>
<p><strong>æƒé™ç»§æ‰¿</strong>ï¼šDocument çš„è®¿é—®æƒé™åŸºäº Workspace æˆå‘˜æƒé™</p>
<h4>5. æˆå‘˜ç®¡ç†æœºåˆ¶</h4>
<p><strong>é‚€è¯·æµç¨‹ï¼ˆInvitationï¼‰</strong>ï¼š</p>
<div class="mermaid">sequenceDiagram
    participant Admin as ğŸ‘¤ ç®¡ç†å‘˜<br/>(owner/admin)
    participant System as ğŸŒ ç³»ç»Ÿ
    participant User as ğŸ‘¤ è¢«é‚€è¯·ç”¨æˆ·
    participant Email as ğŸ“§ é‚®ä»¶

    Admin->>System: POST /organizations/{id}/invitations<br/>åˆ›å»ºé‚€è¯·
    System->>Email: å‘é€é‚€è¯·é‚®ä»¶ï¼ˆåŒ…å«ä»¤ç‰Œé“¾æ¥ï¼‰
    Email->>User: æ¥æ”¶é‚®ä»¶
    User->>System: POST /invitations/{token}/accept<br/>æ¥å—é‚€è¯·
    System->>System: åˆ›å»º OrganizationMember
    System-->>User: æˆåŠŸåŠ å…¥ç»„ç»‡
    
    Note over Admin,User: ç®¡ç†å‘˜å¯ä»¥æ’¤é”€æœªæ¥å—çš„é‚€è¯·<br/>DELETE /invitations/{id}</div>
<p><strong>åŠ å…¥ç”³è¯·æµç¨‹ï¼ˆJoin Requestï¼‰</strong>ï¼š</p>
<div class="mermaid">sequenceDiagram
    participant User as ğŸ‘¤ ç”³è¯·ç”¨æˆ·
    participant System as ğŸŒ ç³»ç»Ÿ
    participant Admin as ğŸ‘¤ ç®¡ç†å‘˜<br/>(owner/admin)

    User->>System: POST /organizations/{id}/join-requests<br/>æäº¤ç”³è¯·
    System->>Admin: é€šçŸ¥æœ‰æ–°ç”³è¯·
    Admin->>System: GET /join-requests<br/>æŸ¥çœ‹ç”³è¯·åˆ—è¡¨
    
    alt æ‰¹å‡†ç”³è¯·
        Admin->>System: POST /join-requests/{id}/approve<br/>æ‰¹å‡†
        System->>System: åˆ›å»º OrganizationMember
        System-->>User: é€šçŸ¥ç”³è¯·é€šè¿‡
    else æ‹’ç»ç”³è¯·
        Admin->>System: POST /join-requests/{id}/reject<br/>æ‹’ç»
        System-->>User: é€šçŸ¥ç”³è¯·è¢«æ‹’ç»ï¼ˆå«åŸå› ï¼‰
    end
    
    Note over User,Admin: ç”¨æˆ·å¯ä»¥å–æ¶ˆè‡ªå·±çš„ç”³è¯·<br/>DELETE /join-requests/{id}</div>
<h4>6. è§’è‰²æƒé™çŸ©é˜µ</h4>
<p><strong>Organization è§’è‰²æƒé™</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>owner</th>
<th>admin</th>
<th>member</th>
<th>guest</th>
</tr>
</thead>
<tbody><tr>
<td>æŸ¥çœ‹ç»„ç»‡ä¿¡æ¯</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>æ›´æ–°ç»„ç»‡è®¾ç½®</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>åˆ é™¤ç»„ç»‡</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>é‚€è¯·æˆå‘˜</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>ç®¡ç†æˆå‘˜è§’è‰²</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>ç§»é™¤æˆå‘˜</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>åˆ›å»ºå·¥ä½œåŒº</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>ç®¡ç†å·¥ä½œåŒº</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
</tbody></table>
<p><strong>Workspace è§’è‰²æƒé™</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>owner</th>
<th>editor</th>
<th>viewer</th>
</tr>
</thead>
<tbody><tr>
<td>æŸ¥çœ‹å·¥ä½œåŒº</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>æŸ¥çœ‹æ–‡æ¡£</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>åˆ›å»ºæ–‡æ¡£</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td>ç¼–è¾‘æ–‡æ¡£</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td>åˆ é™¤æ–‡æ¡£</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td>ç®¡ç†æˆå‘˜</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>å·¥ä½œåŒºè®¾ç½®</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
</tbody></table>
<h4>7. æ•°æ®éš”ç¦»ä¸å®‰å…¨</h4>
<p><strong>éš”ç¦»å±‚çº§</strong>ï¼š</p>
<pre><code>Organizationï¼ˆç§Ÿæˆ·çº§éš”ç¦»ï¼‰
  â””â”€â”€ Workspaceï¼ˆä¸šåŠ¡çº§éš”ç¦»ï¼‰
        â””â”€â”€ Documentï¼ˆæ–‡æ¡£çº§éš”ç¦»ï¼‰
              â”œâ”€â”€ Propertiesï¼ˆæ–‡æ¡£å±æ€§ï¼‰
              â”œâ”€â”€ Metadataï¼ˆå­—æ®µå®šä¹‰ï¼‰
              â”œâ”€â”€ Dataï¼ˆæ•°æ®è¡Œï¼‰
              â””â”€â”€ Viewsï¼ˆè§†å›¾é…ç½®ï¼‰
</code></pre>
<p><strong>æƒé™æ ¡éªŒæµç¨‹</strong>ï¼š</p>
<ol>
<li><strong>ç”¨æˆ·èº«ä»½éªŒè¯</strong>ï¼šéªŒè¯ JWT Token</li>
<li><strong>ç»„ç»‡æˆå‘˜æ£€æŸ¥</strong>ï¼šç¡®è®¤ç”¨æˆ·æ˜¯è¯¥ Organization çš„æˆå‘˜</li>
<li><strong>å·¥ä½œåŒºæƒé™æ£€æŸ¥</strong>ï¼šç¡®è®¤ç”¨æˆ·åœ¨è¯¥ Workspace ä¸­çš„è§’è‰²</li>
<li><strong>æ“ä½œæƒé™éªŒè¯</strong>ï¼šæ ¹æ®è§’è‰²éªŒè¯æ˜¯å¦æœ‰æƒé™æ‰§è¡Œæ“ä½œ</li>
<li><strong>æ•°æ®è®¿é—®æ§åˆ¶</strong>ï¼šä»…è¿”å›ç”¨æˆ·æœ‰æƒè®¿é—®çš„æ•°æ®</li>
</ol>
<h3>å…¸å‹ä½¿ç”¨åœºæ™¯</h3>
<h4>åœºæ™¯ 1ï¼šæ–°ç”¨æˆ·æ³¨å†Œ</h4>
<pre><code class="language-bash"># 1. ç”¨æˆ·æ³¨å†Œ
POST /api/v1/auth/register
{
  &quot;email&quot;: &quot;user@example.com&quot;,
  &quot;password&quot;: &quot;******&quot;,
  &quot;displayName&quot;: &quot;å¼ ä¸‰&quot;
}

# ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œï¼š
# - åˆ›å»º User è®°å½•
# - åˆ›å»ºä¸ªäºº Organizationï¼ˆtype: personalï¼‰
# - åˆ›å»ºé»˜è®¤ Workspace
# - è®¾ç½®ç”¨æˆ·ä¸º Organization owner
</code></pre>
<h4>åœºæ™¯ 2ï¼šåˆ›å»ºå›¢é˜Ÿç»„ç»‡</h4>
<pre><code class="language-bash"># 2. åˆ›å»ºé¤é¥®é›†å›¢ç»„ç»‡
POST /api/v1/organizations
{
  &quot;name&quot;: &quot;é²œé£Ÿé¤é¥®é›†å›¢&quot;,
  &quot;slug&quot;: &quot;fresh-dining&quot;,
  &quot;type&quot;: &quot;enterprise&quot;,
  &quot;description&quot;: &quot;é¤é¥®é›†å›¢ä¾›åº”é“¾ç®¡ç†&quot;
}

# è¿”å›ï¼š
# - Organization ID
# - è‡ªåŠ¨åˆ›å»ºé»˜è®¤ Workspace
# - åˆ›å»ºè€…æˆä¸º owner
</code></pre>
<h4>åœºæ™¯ 3ï¼šåˆ›å»ºä¸»æ•°æ®ä¸­å¿ƒ</h4>
<pre><code class="language-bash"># 3. åˆ›å»ºå…±äº«çš„ä¸»æ•°æ®å·¥ä½œåŒº
POST /api/v1/organizations/{orgId}/workspaces
{
  &quot;name&quot;: &quot;ğŸ“š ä¸»æ•°æ®ä¸­å¿ƒ&quot;,
  &quot;slug&quot;: &quot;master-data&quot;,
  &quot;description&quot;: &quot;é›†å›¢å…±äº«ä¸»æ•°æ®ç®¡ç†&quot;,
  &quot;visibility&quot;: &quot;public&quot;,  // ç»„ç»‡å†…æ‰€æœ‰æˆå‘˜å¯è§
  &quot;settings&quot;: {
    &quot;isShared&quot;: true,      // è‡ªå®šä¹‰æ ‡è¯†ï¼šå…±äº«å·¥ä½œåŒº
    &quot;isMasterData&quot;: true   // è‡ªå®šä¹‰æ ‡è¯†ï¼šä¸»æ•°æ®å·¥ä½œåŒº
  }
}

# 4. æ·»åŠ æ•°æ®ç®¡ç†å‘˜ï¼ˆå¯ç¼–è¾‘ä¸»æ•°æ®ï¼‰
POST /api/v1/organizations/{orgId}/workspaces/{masterDataWsId}/members
{
  &quot;userId&quot;: &quot;admin-user-id&quot;,
  &quot;role&quot;: &quot;editor&quot;  // æœ‰æƒç¼–è¾‘äº§å“ç›®å½•
}

# 5. åœ¨ä¸»æ•°æ®ä¸­å¿ƒåˆ›å»ºäº§å“ç›®å½•
POST /api/v1/doc/product/create
{
  &quot;workspaceId&quot;: &quot;{masterDataWsId}&quot;,
  &quot;name&quot;: &quot;é›†å›¢äº§å“ç›®å½•&quot;,
  &quot;metadata&quot;: {
    &quot;fields&quot;: [
      {&quot;id&quot;: &quot;name&quot;, &quot;name&quot;: &quot;èœå“åç§°&quot;, &quot;type&quot;: &quot;text&quot;},
      {&quot;id&quot;: &quot;category&quot;, &quot;name&quot;: &quot;ç±»åˆ«&quot;, &quot;type&quot;: &quot;single_select&quot;},
      {&quot;id&quot;: &quot;unit_price&quot;, &quot;name&quot;: &quot;æ ‡å‡†ä»·æ ¼&quot;, &quot;type&quot;: &quot;currency&quot;},
      {&quot;id&quot;: &quot;unit&quot;, &quot;name&quot;: &quot;è®¡é‡å•ä½&quot;, &quot;type&quot;: &quot;text&quot;}
    ]
  }
}

# 6. æ·»åŠ äº§å“æ•°æ®
POST /api/v1/doc/product/{productDocId}/data
{
  &quot;values&quot;: [
    {&quot;fieldId&quot;: &quot;name&quot;, &quot;value&quot;: {&quot;text&quot;: &quot;å®«ä¿é¸¡ä¸&quot;}},
    {&quot;fieldId&quot;: &quot;category&quot;, &quot;value&quot;: {&quot;selectOption&quot;: {&quot;id&quot;: &quot;main-course&quot;}}},
    {&quot;fieldId&quot;: &quot;unit_price&quot;, &quot;value&quot;: {&quot;currency&quot;: 48.00}},
    {&quot;fieldId&quot;: &quot;unit&quot;, &quot;value&quot;: {&quot;text&quot;: &quot;ä»½&quot;}}
  ]
}
</code></pre>
<h4>åœºæ™¯ 4ï¼šé‚€è¯·å›¢é˜Ÿæˆå‘˜</h4>
<pre><code class="language-bash"># 7. é‚€è¯·æˆå‘˜åŠ å…¥ç»„ç»‡
POST /api/v1/organizations/{orgId}/invitations
{
  &quot;email&quot;: &quot;manager@example.com&quot;,
  &quot;role&quot;: &quot;admin&quot;,
  &quot;message&quot;: &quot;æ¬¢è¿åŠ å…¥é¤é¥®é›†å›¢ç®¡ç†å›¢é˜Ÿï¼&quot;
}

# 8. è¢«é‚€è¯·äººæ¥å—é‚€è¯·
POST /api/v1/invitations/{token}/accept

# 9. å°†é¤å…ç»ç†åŠ å…¥ä¸»æ•°æ®ä¸­å¿ƒï¼ˆviewer è§’è‰²ï¼‰
POST /api/v1/organizations/{orgId}/workspaces/{masterDataWsId}/members
{
  &quot;userId&quot;: &quot;manager-user-id&quot;,
  &quot;role&quot;: &quot;viewer&quot;  // åªè¯»è®¿é—®ï¼Œä¸èƒ½ä¿®æ”¹ä¸»æ•°æ®
}
</code></pre>
<h4>åœºæ™¯ 5ï¼šåˆ›å»ºä¸šåŠ¡å·¥ä½œåŒº</h4>
<pre><code class="language-bash"># 10a. åˆ›å»ºé¤å…å·¥ä½œåŒº
POST /api/v1/organizations/{orgId}/workspaces
{
  &quot;name&quot;: &quot;ğŸœ æœé˜³é¤å…&quot;,
  &quot;slug&quot;: &quot;chaoyang-restaurant&quot;,
  &quot;description&quot;: &quot;æœé˜³åº—è¿è¥ç®¡ç†&quot;,
  &quot;visibility&quot;: &quot;private&quot;
}

# 10b. åˆ›å»ºè¶…å¸‚å·¥ä½œåŒº
POST /api/v1/organizations/{orgId}/workspaces
{
  &quot;name&quot;: &quot;ğŸ›ï¸ æµ·æ·€è¶…å¸‚&quot;,
  &quot;slug&quot;: &quot;haidian-supermarket&quot;,
  &quot;description&quot;: &quot;æµ·æ·€åº—é‡‡è´­ä¸åº“å­˜ç®¡ç†&quot;,
  &quot;visibility&quot;: &quot;private&quot;
}

# 10c. åˆ›å»ºä¾›åº”å•†å·¥ä½œåŒº
POST /api/v1/organizations/{orgId}/workspaces
{
  &quot;name&quot;: &quot;ğŸšš ç»¿æºä¾›åº”å•†&quot;,
  &quot;slug&quot;: &quot;greensource-supplier&quot;,
  &quot;description&quot;: &quot;ç»¿æºä¾›åº”å•†è®¢å•ç®¡ç†&quot;,
  &quot;visibility&quot;: &quot;private&quot;
}

# 11. æ·»åŠ é¤å…ç»ç†åˆ°å·¥ä½œåŒº
POST /api/v1/organizations/{orgId}/workspaces/{restaurantWsId}/members
{
  &quot;userId&quot;: &quot;restaurant-manager-id&quot;,
  &quot;role&quot;: &quot;owner&quot;  // é¤å…è´Ÿè´£äºº
}

# 12. æ·»åŠ è¶…å¸‚é‡‡è´­å‘˜åˆ°å·¥ä½œåŒº
POST /api/v1/organizations/{orgId}/workspaces/{supermarketWsId}/members
{
  &quot;userId&quot;: &quot;purchaser-user-id&quot;,
  &quot;role&quot;: &quot;editor&quot;  // å¯ç¼–è¾‘è®¢è´§å•
}
</code></pre>
<h4>åœºæ™¯ 6ï¼šåˆ›å»ºè®¢è´§å•å¹¶å¼•ç”¨ä¸»æ•°æ®</h4>
<pre><code class="language-bash"># 13. åœ¨é¤å…å·¥ä½œåŒºåˆ›å»ºè®¢è´§å•
POST /api/v1/doc/purchase/create
{
  &quot;workspaceId&quot;: &quot;{restaurantWsId}&quot;,
  &quot;name&quot;: &quot;2024å¹´12æœˆè®¢è´§å•&quot;,
  &quot;metadata&quot;: {
    &quot;fields&quot;: [
      {
        &quot;id&quot;: &quot;product&quot;,
        &quot;name&quot;: &quot;äº§å“&quot;,
        &quot;type&quot;: &quot;relation&quot;,
        &quot;config&quot;: {
          // å…³è”åˆ°ä¸»æ•°æ®ä¸­å¿ƒçš„äº§å“ç›®å½•
          &quot;targetWorkspace&quot;: &quot;{masterDataWsId}&quot;,
          &quot;targetDocument&quot;: &quot;{productDocId}&quot;,
          &quot;displayFields&quot;: [&quot;name&quot;, &quot;category&quot;, &quot;unit_price&quot;]
        }
      },
      {&quot;id&quot;: &quot;quantity&quot;, &quot;name&quot;: &quot;æ•°é‡&quot;, &quot;type&quot;: &quot;number&quot;},
      {&quot;id&quot;: &quot;total_price&quot;, &quot;name&quot;: &quot;æ€»ä»·&quot;, &quot;type&quot;: &quot;currency&quot;}
    ]
  }
}

# 14. æ·»åŠ è®¢è´§æ•°æ®ï¼ˆå¼•ç”¨ä¸»æ•°æ®ï¼‰
POST /api/v1/doc/purchase/{purchaseDocId}/data
{
  &quot;values&quot;: [
    {
      &quot;fieldId&quot;: &quot;product&quot;,
      &quot;value&quot;: {
        &quot;relation&quot;: {
          // è·¨ Workspace å¼•ç”¨ä¸»æ•°æ®ä¸­å¿ƒçš„äº§å“
          &quot;workspaceId&quot;: &quot;{masterDataWsId}&quot;,
          &quot;documentId&quot;: &quot;{productDocId}&quot;,
          &quot;rowId&quot;: &quot;product-001&quot;  // å®«ä¿é¸¡ä¸
        }
      }
    },
    {&quot;fieldId&quot;: &quot;quantity&quot;, &quot;value&quot;: {&quot;number&quot;: 50}},
    {&quot;fieldId&quot;: &quot;total_price&quot;, &quot;value&quot;: {&quot;currency&quot;: 2400.00}}
  ]
}

# ä¼˜åŠ¿ï¼š
# - äº§å“ä¿¡æ¯ç»Ÿä¸€ç»´æŠ¤ï¼Œä¸»æ•°æ®ä¸­å¿ƒæ›´æ–°åæ‰€æœ‰å¼•ç”¨å¤„è‡ªåŠ¨ç”Ÿæ•ˆ
# - é¿å…å¤šå¤„é‡å¤å½•å…¥ç›¸åŒäº§å“ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
# - é›†å›¢çº§äº§å“ä»·æ ¼è°ƒæ•´æ—¶ï¼Œæ‰€æœ‰é¤å…çš„è®¢è´§å•è‡ªåŠ¨åŒæ­¥
</code></pre>
<h4>åœºæ™¯ 7ï¼šæŸ¥çœ‹å…±äº«æ•°æ®</h4>
<h3>æ¶æ„ä¼˜åŠ¿</h3>
<ol>
<li><strong>çµæ´»çš„ç»„ç»‡ç»“æ„</strong>ï¼šæ”¯æŒä¸ªäººã€å›¢é˜Ÿã€ä¼ä¸šå¤šç§ç»„ç»‡ç±»å‹</li>
<li><strong>ç»†ç²’åº¦æƒé™æ§åˆ¶</strong>ï¼šOrganization å’Œ Workspace åŒå±‚è§’è‰²ä½“ç³»</li>
<li><strong>ä¸šåŠ¡éš”ç¦»</strong>ï¼šä¸åŒä¸šåŠ¡ï¼ˆé¤å…ã€è¶…å¸‚ã€ä¾›åº”å•†ã€ä»“åº“ï¼‰ç‹¬ç«‹ç®¡ç†</li>
<li><strong>åä½œå‹å¥½</strong>ï¼šå®Œå–„çš„é‚€è¯·å’Œç”³è¯·æœºåˆ¶</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ”¯æŒæ— é™æ‰©å±• Workspace å’Œ Document</li>
<li><strong>ä¸»æ•°æ®ç®¡ç†</strong>ï¼šé€šè¿‡å…±äº« Workspace å®ç°ç»„ç»‡çº§ä¸»æ•°æ®ç»Ÿä¸€ç®¡ç†</li>
<li><strong>æ•°æ®ä¸€è‡´æ€§</strong>ï¼šè·¨ Workspace å¼•ç”¨æœºåˆ¶ï¼Œä¸»æ•°æ®æ›´æ–°è‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰å¼•ç”¨å¤„</li>
</ol>
<h2>ç›®å½•ç»“æ„</h2>
<pre><code>api/
â”œâ”€â”€ main.tsp                    # é¡¶å±‚å…¥å£
â”‚
â”œâ”€â”€ shared/                     # å…±äº«åŸºç¡€æ¨¡å—
â”‚   â”œâ”€â”€ common.tsp             # é€šç”¨ç±»å‹ï¼ˆApiResponse, Filter, Value...ï¼‰
â”‚   â”œâ”€â”€ constants.tsp          # æšä¸¾å®šä¹‰
â”‚   â””â”€â”€ index.tsp              # æ¨¡å—å…¥å£
â”‚
â”œâ”€â”€ auth/                       # è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ models.tsp             # OAuth2/OIDC æ¨¡å‹
â”‚   â””â”€â”€ index.tsp              # æ¨¡å—å…¥å£
â”‚
â””â”€â”€ document/                   # æ–‡æ¡£æ¨¡å—
    â”œâ”€â”€ core/                  # æ ¸å¿ƒæ•°æ®æ¨¡å‹
    â”‚   â”œâ”€â”€ metadata.tsp       # å­—æ®µå®šä¹‰
    â”‚   â”œâ”€â”€ data.tsp           # æ•°æ®è¡Œç®¡ç†
    â”‚   â”œâ”€â”€ properties.tsp     # æ–‡æ¡£å±æ€§
    â”‚   â”œâ”€â”€ views.tsp          # è§†å›¾é…ç½®
    â”‚   â”œâ”€â”€ settings.tsp       # è®¾ç½®
    â”‚   â””â”€â”€ index.tsp
    â”‚
    â”œâ”€â”€ content/               # å†…å®¹åä½œ
    â”‚   â”œâ”€â”€ comments.tsp       # è¯„è®ºç³»ç»Ÿ
    â”‚   â””â”€â”€ index.tsp
    â”‚
    â”œâ”€â”€ workflow/              # å·¥ä½œæµç®¡ç†
    â”‚   â”œâ”€â”€ approvals.tsp      # å®¡æ‰¹æµç¨‹
    â”‚   â”œâ”€â”€ requests.tsp       # å˜æ›´è¯·æ±‚
    â”‚   â”œâ”€â”€ revisions.tsp      # ä¿®è®¢å†å²
    â”‚   â””â”€â”€ index.tsp
    â”‚
    â”œâ”€â”€ aggregate/             # èšåˆæŸ¥è¯¢
    â”‚   â””â”€â”€ index.tsp
    â”‚
    â”œâ”€â”€ operations/            # é¢„ç•™ç›®å½•
    â””â”€â”€ index.tsp
</code></pre>
<h2>æ¶æ„å±‚æ¬¡</h2>
<div class="mermaid">graph TB
    subgraph "é¡¶å±‚ Top Level"
        Main["ğŸ“„ main.tsp<br/>é¡¶å±‚å…¥å£"]
    end
    
    subgraph "åŸºç¡€å±‚ Foundation Layer"
        Shared["ğŸ“¦ shared/<br/>å…±äº«åŸºç¡€æ¨¡å—"]
        Common["common.tsp<br/>é€šç”¨ç±»å‹"]
        Constants["constants.tsp<br/>æšä¸¾å®šä¹‰"]
        
        Shared --> Common
        Shared --> Constants
    end
    
    subgraph "è®¤è¯å±‚ Auth Layer"
        Auth["ğŸ” auth/<br/>è®¤è¯æ¨¡å—"]
        AuthModels["models.tsp<br/>OAuth2/OIDC"]
        
        Auth --> AuthModels
    end
    
    subgraph "ä¸šåŠ¡å±‚ Business Layer"
        Document["ğŸ“š document/<br/>æ–‡æ¡£æ¨¡å—"]
        
        subgraph "æ ¸å¿ƒ Core"
            Core["core/"]
            Metadata["metadata.tsp"]
            Data["data.tsp"]
            Properties["properties.tsp"]
            Views["views.tsp"]
            Settings["settings.tsp"]
            
            Core --> Metadata
            Core --> Data
            Core --> Properties
            Core --> Views
            Core --> Settings
        end
        
        subgraph "åä½œ Content"
            Content["content/"]
            Comments["comments.tsp"]
            
            Content --> Comments
        end
        
        subgraph "å·¥ä½œæµ Workflow"
            Workflow["workflow/"]
            Approvals["approvals.tsp"]
            Requests["requests.tsp"]
            Revisions["revisions.tsp"]
            
            Workflow --> Approvals
            Workflow --> Requests
            Workflow --> Revisions
        end
        
        subgraph "èšåˆ Aggregate"
            Aggregate["aggregate/"]
            AggregateAPI["index.tsp"]
            
            Aggregate --> AggregateAPI
        end
        
        Document --> Core
        Document --> Content
        Document --> Workflow
        Document --> Aggregate
    end
    
    subgraph "æ‰©å±•å±‚ Extension Layer"
        Extensions["ğŸ”Œ extensions/<br/>æ‰©å±•æ¨¡å—<br/><small>é¢„ç•™</small>"]
        Integrations["integrations/"]
        Webhooks["webhooks/"]
        
        Extensions -.-> Integrations
        Extensions -.-> Webhooks
    end
    
    Main --> Shared
    Main --> Auth
    Main --> Document
    Main -.-> Extensions
    
    Auth --> Shared
    Document --> Shared
    Extensions -.-> Shared
    
    Core --> Shared
    Content --> Shared
    Workflow --> Shared
    Aggregate --> Shared
    
    Workflow --> Core
    Aggregate --> Core
    Aggregate --> Content
    Aggregate --> Workflow</div>
<p><strong>ä¾èµ–å…³ç³»è¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>å®çº¿ç®­å¤´</strong> - ç›´æ¥ä¾èµ–å…³ç³»</li>
<li><strong>è™šçº¿ç®­å¤´</strong> - é¢„ç•™/å¯é€‰ä¾èµ–</li>
<li><strong>é¢œè‰²åˆ†å±‚</strong> - è“è‰²ï¼ˆé¡¶å±‚ï¼‰â†’ æ©™è‰²ï¼ˆåŸºç¡€ï¼‰â†’ ç²‰è‰²ï¼ˆè®¤è¯ï¼‰â†’ ç»¿è‰²ï¼ˆä¸šåŠ¡ï¼‰â†’ ç´«è‰²ï¼ˆæ‰©å±•ï¼‰</li>
</ul>
<p><strong>ä¾èµ–åŸåˆ™ï¼š</strong></p>
<ol>
<li><strong>å•å‘ä¾èµ–</strong> - ä¸Šå±‚ä¾èµ–ä¸‹å±‚ï¼Œä¸‹å±‚ä¸ä¾èµ–ä¸Šå±‚</li>
<li><strong>åŸºç¡€ä¼˜å…ˆ</strong> - æ‰€æœ‰æ¨¡å—éƒ½ä¾èµ– shared åŸºç¡€å±‚</li>
<li><strong>æ¨¡å—ç‹¬ç«‹</strong> - åŒå±‚æ¨¡å—ä¹‹é—´å°½é‡ç‹¬ç«‹</li>
<li><strong>èšåˆç»„åˆ</strong> - aggregate æ¨¡å—ç»„åˆå…¶ä»–æ¨¡å—çš„åŠŸèƒ½</li>
</ol>
<h2>è®¾è®¡åŸåˆ™</h2>
<ol>
<li><strong>åˆ†å±‚æ¶æ„</strong> - æ¸…æ™°çš„ 4 å±‚ç»“æ„ï¼ˆshared â†’ auth â†’ document â†’ extensionsï¼‰</li>
<li><strong>å•ä¸€èŒè´£</strong> - æ¯ä¸ªæ¨¡å—åŠŸèƒ½æ˜ç¡®ï¼ŒèŒè´£å•ä¸€</li>
<li><strong>ä¾èµ–ç®¡ç†</strong> - æ˜ç¡®çš„ä¾èµ–å…³ç³»ï¼Œé¿å…å¾ªç¯ä¾èµ–</li>
<li><strong>å¯æ‰©å±•æ€§</strong> - é¢„ç•™æ‰©å±•ç›®å½•ï¼Œæ”¯æŒåŠ¨æ€æ‰©å±•</li>
<li><strong>æ¨¡å—åŒ–</strong> - é«˜å†…èšä½è€¦åˆï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•</li>
</ol>
<h2>æ¨¡å—èŒè´£</h2>
<table>
<thead>
<tr>
<th>æ¨¡å—</th>
<th>èŒè´£</th>
<th>ä¸»è¦å†…å®¹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>shared</strong></td>
<td>åŸºç¡€è®¾æ–½</td>
<td>é€šç”¨ç±»å‹ã€é”™è¯¯ç ã€è¿‡æ»¤å™¨ã€èšåˆå‡½æ•°</td>
</tr>
<tr>
<td><strong>auth</strong></td>
<td>è®¤è¯æˆæƒ</td>
<td>OAuth2ã€OIDCã€JWTã€ç”¨æˆ·ä¿¡æ¯</td>
</tr>
<tr>
<td><strong>document/core</strong></td>
<td>æ ¸å¿ƒæ•°æ®</td>
<td>å…ƒæ•°æ®ã€æ•°æ®è¡Œã€å±æ€§ã€è§†å›¾ã€è®¾ç½®</td>
</tr>
<tr>
<td><strong>document/content</strong></td>
<td>å†…å®¹åä½œ</td>
<td>è¯„è®ºç³»ç»Ÿ</td>
</tr>
<tr>
<td><strong>document/workflow</strong></td>
<td>å·¥ä½œæµ</td>
<td>å®¡æ‰¹ã€è¯·æ±‚ã€ä¿®è®¢</td>
</tr>
<tr>
<td><strong>document/aggregate</strong></td>
<td>èšåˆæŸ¥è¯¢</td>
<td>ä¸€æ¬¡æ€§è·å–å¤šç§æ•°æ®</td>
</tr>
<tr>
<td><strong>extensions</strong></td>
<td>æ‰©å±•åŠŸèƒ½</td>
<td>é›†æˆã€Webhooksï¼ˆé¢„ç•™ï¼‰</td>
</tr>
</tbody></table>
<h2>æ•°æ®æµä¸å·¥ä½œæµ</h2>
<div class="mermaid">sequenceDiagram
    participant User as ğŸ‘¤ ç”¨æˆ·
    participant API as ğŸŒ API
    participant Request as ğŸ“ Request
    participant Approval as âœ… Approval
    participant Revision as ğŸ“œ Revision
    participant Data as ğŸ“Š Data Store

    Note over User,Data: åœºæ™¯ 1: ç›´æ¥åº”ç”¨å˜æ›´ (apply=true)
    User->>API: POST /data?apply=true
    API->>Data: ç›´æ¥å†™å…¥æ•°æ®
    API->>Revision: ç”Ÿæˆä¿®è®¢è®°å½•
    Revision-->>User: è¿”å›ä¿®è®¢ ID
    
    Note over User,Data: åœºæ™¯ 2: åˆ›å»ºå˜æ›´è¯·æ±‚ï¼ˆé»˜è®¤ï¼‰
    User->>API: POST /data
    API->>Request: åˆ›å»º Request
    Request-->>User: è¿”å› Request ID
    
    Note over User,Data: åœºæ™¯ 3: å¤šäººåä½œç¼–è¾‘
    User->>Request: æ·»åŠ /ä¿®æ”¹å˜æ›´
    User->>Request: ç»§ç»­ç¼–è¾‘
    Note over Request: å¤šä¸ªç”¨æˆ·å¯ä»¥<br/>åœ¨åŒä¸€ Request ä¸­<br/>åä½œç¼–è¾‘
    
    Note over User,Data: åœºæ™¯ 4: å®¡æ‰¹æµç¨‹
    User->>API: POST /requests/{id}/merge
    API->>Approval: è§¦å‘å®¡æ‰¹æµç¨‹
    Approval->>Approval: å¤šå±‚çº§å®¡æ‰¹
    alt å®¡æ‰¹é€šè¿‡
        Approval->>Request: æ‰¹å‡†åˆå¹¶
        Request->>Data: åº”ç”¨å˜æ›´
        Request->>Revision: ç”Ÿæˆä¿®è®¢
        Revision-->>User: å®Œæˆ
    else å®¡æ‰¹æ‹’ç»
        Approval->>Request: æ‹’ç»
        Request-->>User: éœ€è¦ä¿®æ”¹
    end
    
    Note over User,Data: åœºæ™¯ 5: ç‰ˆæœ¬å¯¹æ¯”ä¸å›æ»š
    User->>API: GET /revisions/{id}/diff?base={base-id}
    API-->>User: è¿”å›å·®å¼‚
    User->>API: POST /revisions/{id}/revert
    API->>Request: åˆ›å»ºå›æ»š Request
    Request->>Data: åº”ç”¨å›æ»š
    API->>Revision: ç”Ÿæˆå›æ»šä¿®è®¢
    Revision-->>User: å®Œæˆå›æ»š</div>
<p><strong>å·¥ä½œæµè¯´æ˜ï¼š</strong></p>
<ol>
<li><strong>ç›´æ¥åº”ç”¨</strong> - ä½¿ç”¨ <code>?apply=true</code> å‚æ•°ç›´æ¥å†™å…¥æ•°æ®å¹¶ç”Ÿæˆä¿®è®¢</li>
<li><strong>å˜æ›´è¯·æ±‚</strong> - é»˜è®¤åˆ›å»º Requestï¼Œæ”¯æŒå¤šäººåä½œç¼–è¾‘</li>
<li><strong>å®¡æ‰¹æµç¨‹</strong> - å¯é€‰çš„å¤šå±‚çº§å®¡æ‰¹æœºåˆ¶</li>
<li><strong>ä¿®è®¢è¿½è¸ª</strong> - æ‰€æœ‰å˜æ›´éƒ½ä¼šç”Ÿæˆä¿®è®¢è®°å½•</li>
<li><strong>ç‰ˆæœ¬å›æ»š</strong> - æ”¯æŒå¯¹æ¯”å’Œå›æ»šåˆ°ä»»æ„å†å²ç‰ˆæœ¬</li>
</ol>
<h2>å­—æ®µç±»å‹ä¸å€¼ç±»å‹æ˜ å°„</h2>
<div class="mermaid">graph LR
    subgraph "å­—æ®µç±»å‹ Field Types"
        F1["text<br/>long_text"]
        F2["number<br/>currency<br/>percent"]
        F3["boolean"]
        F4["date<br/>datetime"]
        F5["duration"]
        F6["single_select"]
        F7["multi_select"]
        F8["rating"]
        F9["attachment"]
        F10["user"]
        F11["collaborator"]
        F12["relation"]
        F13["lookup<br/>rollup<br/>formula"]
    end
    
    subgraph "å€¼ç±»å‹ Value Types"
        V1["string"]
        V2["float64"]
        V3["boolean"]
        V4["string<br/><small>ISO 8601</small>"]
        V5["int64<br/><small>æ¯«ç§’</small>"]
        V6["SelectOption"]
        V7["SelectOption[]"]
        V8["int32<br/><small>1-5</small>"]
        V9["Attachment[]"]
        V10["UserRef"]
        V11["CollaboratorRef"]
        V12["RelationRef[]"]
        V13["<small>åŠ¨æ€ç±»å‹</small>"]
    end
    
    F1 --> V1
    F2 --> V2
    F3 --> V3
    F4 --> V4
    F5 --> V5
    F6 --> V6
    F7 --> V7
    F8 --> V8
    F9 --> V9
    F10 --> V10
    F11 --> V11
    F12 --> V12
    F13 --> V13</div>
<h2>æ–‡æ¡£ç±»å‹è·¯ç”±</h2>
<p><strong>Provider æ¨¡å¼ï¼š</strong></p>
<pre><code>/api/v1/doc/{doc-type}/{doc-id}
              â†“
        Provider è§£æ
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼         â–¼         â–¼
 Product  Purchase   Invoice
 Provider  Provider  Provider
</code></pre>
<p><strong>æ‰©å±•æ–°ç±»å‹ï¼š</strong></p>
<ul>
<li>å®ç°å¯¹åº”çš„ Provider</li>
<li>æ³¨å†Œåˆ°è·¯ç”±ç³»ç»Ÿ</li>
<li>æ— éœ€ä¿®æ”¹ API å®šä¹‰</li>
</ul>
<h2>èµ„æºæŠ½è±¡</h2>
<pre><code>Doc: {doc-type} + {doc-id}
  â”œâ”€â”€ properties    # æ–‡æ¡£å±æ€§ï¼ˆè®¢å•æ—¶é—´ã€é—¨åº—ã€é‡‘é¢ç­‰ï¼‰
  â”œâ”€â”€ metadata      # å­—æ®µå®šä¹‰
  â”œâ”€â”€ views         # è§†å›¾é…ç½®
  â”œâ”€â”€ data          # æ•°æ®è¡Œ
  â”œâ”€â”€ comments      # è¯„è®º
  â”œâ”€â”€ revisions     # ä¿®è®¢å†å²
  â”œâ”€â”€ requests      # å˜æ›´è¯·æ±‚
  â”œâ”€â”€ approval      # å®¡æ‰¹æµç¨‹
  â””â”€â”€ settings      # è®¾ç½®
</code></pre>
<h2>ä¸‹ä¸€æ­¥</h2>
<ul>
<li>æŸ¥çœ‹ <a href="../references/api-reference.md">API å‚è€ƒæ–‡æ¡£</a> äº†è§£è¯¦ç»†çš„ API ç«¯ç‚¹</li>
<li>æŸ¥çœ‹ <a href="./development.md">å¼€å‘æŒ‡å—</a> äº†è§£å¦‚ä½•æ‰©å±•å’Œä¿®æ”¹ API</li>
<li>æŸ¥çœ‹ <a href="./data-operations.md">æ•°æ®æ“ä½œæŒ‡å—</a> äº†è§£æŸ¥è¯¢å’Œè¿‡æ»¤åŠŸèƒ½</li>
</ul>

                </article>
            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <p>&copy; 2024 NexusBook. åŸºäº TypeSpec å®šä¹‰å¹¶ç”Ÿæˆ OpenAPI 3.0 è§„èŒƒã€‚</p>
            </div>
        </footer>
    </div>
</body>
</html>